//Developed by Zarlach
$(document).ready(function(){function t(t,o){for(var n,i,a=t.html(),s=a.split(" "),l=0;l<=s.length;l++)i=s[l],void 0!==o[i]&&i[0]===i[0].toLowerCase()&&(n=new RegExp("\\b"+i+'\\b(?=[^"]*(?:"[^"]*"[^"]*)*$)',"g"),a=a.replace(n,e(i,o[i])));t.html(a)}function e(t,e){return'<img class="emoticon ttv-emo-'+e+'" src="http://static-cdn.jtvnw.net/emoticons/v1/'+e+'/1.0" srcset="http://static-cdn.jtvnw.net/emoticons/v1/'+e+'/2.0 2x" data-id="'+e+'" data-regex="'+t+'" original-title="">'}var o={};if(null===localStorage.getItem("emotes")){$.getJSON("https://twitchemotes.com/api_cache/v2/subscriber.json",function(t){$.each(t.channels,function(t,e){$.each(e.emotes,function(t,e){o[e.code]=e.image_id})})}).done(function(){localStorage.setItem("emotes",JSON.stringify(o))}).fail(function(){$("body").append('<ul id="noty_bottomCenter_layout_container" class="i-am-new" style="bottom: 20px; position: fixed; width: 320px; height: auto; margin: 0px; padding: 0px; list-style-type: none; z-index: 10000; left: 800px;"><li class="noty_bar alert" style="width: 320px;"><div class="noty_bar noty_type_alert" id="noty_152298130185963840"><div class="noty_message"><div class="text-container"><div class="glitch"></div><div class="noty_text"><p>Could not load subscriber emotes :/<br><a href="javascript:history.go(0);">Please refresh</a></p></div></div><div class="noty_close"></div></div></div></li></ul>')})}else o=JSON.parse(localStorage.getItem("emotes"));$(".chat-lines").on("DOMNodeInserted",function(e){if($(e.target).is(".chat-line")){var n=$(this).find(".chat-line").last(),i=n.find(".message"),a=n.find(".badges"),s=n.data("sender");if(console.log(n.html()),console.log(i.html()),console.log("from:"+s),console.log(a.html()),"jtv"!==s&&t(i,o),"zarlach"===s){console.log("found zarlach"),$(a).append('<div class="zar badge" original-title="Developer"></div>');var l=$(a).find(".zar");l.css({background:'url("http://static-cdn.jtvnw.net/emoticons/v1/28073/1.0")',"background-size":"18px 18px"})}else console.log(s+" is not Zarlach")}})});